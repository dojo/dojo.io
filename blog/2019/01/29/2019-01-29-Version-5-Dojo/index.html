<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
	<meta charset="utf-8">
	

	<title>Announcing Dojo 5.0.0 | Dojo</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta property="”og:image”" content="”https://dojo.io/images/og.jpg”">
	<meta name="description" content="Dojo version 5 has arrived!We’re excited to announce the 5.0.0 release of Dojo. This version builds on previous releases with a vast array of bug fixes and improvements throughout the framework.">
<meta property="og:type" content="article">
<meta property="og:title" content="Announcing Dojo 5.0.0">
<meta property="og:url" content="https://dojo.io/blog/2019/01/29/2019-01-29-Version-5-Dojo/index.html">
<meta property="og:site_name" content="Dojo">
<meta property="og:description" content="Dojo version 5 has arrived!We’re excited to announce the 5.0.0 release of Dojo. This version builds on previous releases with a vast array of bug fixes and improvements throughout the framework.">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://dojo.io/blog/2019/01/29/2019-01-29-Version-5-Dojo/featured.png">
<meta property="og:updated_time" content="2019-03-22T14:47:35.838Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Announcing Dojo 5.0.0">
<meta name="twitter:description" content="Dojo version 5 has arrived!We’re excited to announce the 5.0.0 release of Dojo. This version builds on previous releases with a vast array of bug fixes and improvements throughout the framework.">
<meta name="twitter:image" content="https://dojo.io/blog/2019/01/29/2019-01-29-Version-5-Dojo/featured.png">
<meta name="twitter:creator" content="@https:&#x2F;&#x2F;twitter.com&#x2F;dojo">
	
		<link rel="alternate" href="/atom.xml" title="Dojo" type="application/atom+xml">
	
	
		<link rel="icon" href="/images/favicons/favicon.ico">
	
	<link rel="stylesheet" href="/css/main.css">
	
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-3242977-15', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


<link rel="stylesheet" href="/css/prism-vs.css" type="text/css"></head>
</html>
	<body class="body-single-page
">
		<div class="page-wrapper">
			<div uk-sticky="sel-target: .uk-navbar-container; cls-active: uk-navbar-sticky">
	<div class="uk-container uk-container-expand uk-navbar-container">
		<nav class="uk-navbar" uk-navbar>
			<div class="uk-navbar-left">
				<ul class="uk-navbar-nav">
					<li><a href="#sidebar-nav" uk-icon="icon: menu" class="navbar-item uk-hidden@m" uk-toggle="target: #mobile-sidebar"></a></li>
					<li><a href="/" class="navbar-item"><img src="/images/logos/dojo2-logo-white.svg" class="uk-logo site-logo" alt="Dojo"></a></li>
				</ul>
			</div>
			<div class="uk-navbar-right uk-visible@m">
				<ul class="uk-navbar-nav">
					<li><a class="navbar-item" href="/docs.html">Docs</a></li>
<li><a class="navbar-item " href="/tutorials">Tutorials</a></li>
<li><a class="navbar-item" href="/blog">Blog</a></li>
<li><a class="navbar-item" href="/community">Community</a></li>
				</ul>
			</div>
		</nav>
	</div>
</div>

			<div class="content-wrapper">
				<div class="page-content">
					<div class="uk-section uk-container uk-container-small uk-padding-remove-bottom">
	<div class="container article">
		<article id="post-2019-01-29-Version-5-Dojo" class="article uk-article article-type-post" itemscope itemprop="blogPost">
			<div class="article-inner">
				
				
					<header class="article-header uk-margin-bottom">
						
  
    <h1 class="article-title uk-article-title" itemprop="name">
      Announcing Dojo 5.0.0
    </h1>
  

						<div class="article-meta uk-article-meta">
							<div class="author-meta">
	
	<span class="author-name"> Anthony Gubler</span>
	<span class="article-date">
  <time datetime="2019-01-29T08:00:00.000Z" itemprop="datePublished">January 29th 2019, 8:00 am</time>
</span>
</div>
							
						</div>
					</header>
				
				<div class="article-entry" itemprop="articleBody">
					
						<h2 id="Dojo-version-5-has-arrived"><a href="#Dojo-version-5-has-arrived" class="headerlink" title="Dojo version 5 has arrived!"></a>Dojo version 5 has arrived!</h2><p>We’re excited to announce the 5.0.0 release of Dojo. This version builds on previous releases with a vast array of bug fixes and improvements throughout the framework.</p>
<img src="/blog/2019/01/29/2019-01-29-Version-5-Dojo/featured.png" title="feature-full">
<a id="more"></a>
<h3 id="Conditional-Polyfills-Serving-Less-JavaScript"><a href="#Conditional-Polyfills-Serving-Less-JavaScript" class="headerlink" title="Conditional Polyfills - Serving Less JavaScript"></a>Conditional Polyfills - Serving Less JavaScript</h3><p>One of our primary goals for modern Dojo is to improve performance by serving minimal JavaScript bundles by default. For version 5, we’re happy to announce an out of the box solution to optimize the user experience for dealing with bundling and loading polyfills in Dojo applications.</p>
<p>The Dojo build produces separate platform bundles that will be <strong>only</strong> be loaded based on two key conditions:</p>
<p>1) The shim module is imported somewhere in an application.<br>1) A users browser does not natively support the browser feature.</p>
<p>In short, if your application does not use the browser feature or you use a browser with native support, the polyfill will not be loaded! This change means serving less JavaScript and improving your application performance without compromising on features.</p>
<h3 id="New-Polyfills-Added-to-Shim"><a href="#New-Polyfills-Added-to-Shim" class="headerlink" title="New Polyfills Added to Shim"></a>New Polyfills Added to Shim</h3><p>We’ve added additional third party polyfills to <code>@dojo/framework/shim</code>:</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API" target="_blank" rel="noopener"><code>@dojo/framework/shim/fetch</code></a> - The Fetch API provides an interface for fetching resources (including across the network).</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API" target="_blank" rel="noopener"><code>@dojo/framework/shim/IntersectionObserver</code></a> - The Intersection Observer API provides a way to asynchronously observe changes in the intersection of a target element with an ancestor element or with a top-level document’s viewport.</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Animations_API" target="_blank" rel="noopener"><code>@dojo/framework/shim/WebAnimations</code></a> - The Web Animations API allows for synchronizing and timing changes to the presentation of a Web page, i.e. animation of DOM elements.</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/ResizeObserver" target="_blank" rel="noopener"><code>@dojo/framework/shim/ResizeObserver</code></a> - The ResizeObserver interface reports changes to the content rectangle of an Element or the bounding box of an SVGElement. The content rectangle is the box in which content can be placed, meaning the border box minus the padding.</li>
</ul>
<p>To use these additional polyfills they should be imported like any other ponyfill provided by <code>@dojo/framework/shim</code> and they no longer need to be explicitly added/imported to your Dojo application.</p>
<h3 id="Better-Build-Time-Rendering-BTR"><a href="#Better-Build-Time-Rendering-BTR" class="headerlink" title="Better Build Time Rendering (BTR)"></a>Better Build Time Rendering (BTR)</h3><p>Build time rendering provides the rendering of your application to HTML during the build and in-lines critical CSS. BTR allows an application to render static HTML pages and offer some advantages of server-side rendering (SSR) such as performance and search engine optimization without the complexities of running a server to support full SSR. Build time rendering has been available via the Dojo <a href="https://github.com/dojo/cli-build-app#build-time-render-object" target="_blank" rel="noopener">cli-build-app</a>  command since our initial 2.0.0 release.</p>
<p>There are a number of stability and feature enhancements in the 5.0.0 release thanks to the BTR process now running your application in a real browser environment. New features include:</p>
<ul>
<li><a href="#introducing-dojo-blocks">Dojo Blocks</a></li>
<li>Support for <code>StateHistory</code> API (see below)</li>
<li>Multiple page HTML generation</li>
<li>Screenshots of pages visited during Build Time Rendering</li>
<li>Better error messaging</li>
</ul>
<p>Routing support has been extended to support a <code>HistoryManager</code> using the browser <a href="https://developer.mozilla.org/en-US/docs/Web/API/History" target="_blank" rel="noopener">history API</a> via the <code>@dojo/framework/routing/history/StateHistory</code>. For <code>StateHistory</code> BTR produces a static HTML file for each of the paths defined in the build time rendering configuration.</p>
<p>To configure build time rendering to create static pages for the BTR paths, ensure you are using the <code>StateHistory</code> in your application and update your BTR config to specify paths without a <code>#</code> prefix.</p>
<pre class=" language-json"><code class="language-json"><span class="token property">"build-app"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"build-time-render"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"root"</span><span class="token operator">:</span> <span class="token string">"app"</span><span class="token punctuation">,</span>
        <span class="token property">"paths"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">"home"</span><span class="token punctuation">,</span>
            <span class="token string">"about"</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="Introducing-Dojo-Blocks"><a href="#Introducing-Dojo-Blocks" class="headerlink" title="Introducing Dojo Blocks"></a>Introducing Dojo Blocks</h3><p>Dojo Blocks is a new mechanism leveraging Build Time Rendering that allows executing code in Node.js as part of the build. The results from the execution are written to a cache that can then be transparently used in the same way at runtime in the browser. This opens up new opportunities for performing operations that might be not possible or unperformant in a browser.</p>
<p>For example, a Dojo Block module could read a group of markdown files, transform them into VNodes, and make them available to render in the application, all at build time. The result of this Dojo Block module is then cached into the application bundle for use at runtime in the browser.</p>
<p>A Dojo Block module gets used like any other <a href="https://github.com/dojo/framework/blob/master/src/widget-core/README.md#meta-configuration" target="_blank" rel="noopener">meta</a> in any Dojo widget. As a result there is no extensive configuration or alternative authoring patterns needed.</p>
<p>For example, a block module could read a text file and return the content to the application:</p>
<pre class=" language-ts"><code class="language-ts"><span class="token comment" spellcheck="true">// src/read-file.block.ts</span>
<span class="token keyword">import</span> <span class="token operator">*</span> as fs <span class="token keyword">from</span> <span class="token string">'fs'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> resolve <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'path'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span>path<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    path <span class="token operator">=</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Using the <code>text.block.ts</code> module in your application with the <a href="https://github.com/dojo/framework/blob/master/src/widget-core/meta/Block.ts" target="_blank" rel="noopener"><code>Block</code> meta</a>:</p>
<pre class=" language-ts"><code class="language-ts"><span class="token comment" spellcheck="true">// src/MyBlockWidget.ts</span>
<span class="token keyword">import</span> Block <span class="token keyword">from</span> <span class="token string">'@dojo/framework/widget-core/meta/Block'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> WidgetBase <span class="token keyword">from</span> <span class="token string">'@dojo/framework/widget-core/WidgetBase'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> v <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@dojo/framework/widget-core/d'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> readFile <span class="token keyword">from</span> <span class="token string">'./read-file.block'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">MyBlockWidget</span> <span class="token keyword">extends</span> <span class="token class-name">WidgetBase</span> <span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">meta</span><span class="token punctuation">(</span>Block<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>readFile<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">'../content/hello-dojo-blocks.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span> message <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This widget runs the <code>read-file.block.ts</code> module at build time, loading the file path passed which gets used as the children in the widget. The rendered application’s HTML and CSS get written to the built <code>index.html</code>:</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Dojo Blocks<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>theme-color<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#222127<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, initial-scale<span class="token punctuation">=</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>root<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>Hello Dojo Block World!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bootstrap.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
</code></pre>
<h3 id="Simplifying-Testing-with-Assertion-Templates"><a href="#Simplifying-Testing-with-Assertion-Templates" class="headerlink" title="Simplifying Testing with Assertion Templates"></a>Simplifying Testing with Assertion Templates</h3><p>Assertion Templates make testing widgets with the testing harness even easier. Instead of needing to manually curate each <code>expectedRender</code> result per test, you can now use the Assertion Template primitive to easily modify and layer outputs for the expected render.</p>
<p>Assertion Templates allow you to build expected render functions to pass to <code>h.expect()</code>. Assertion Templates always assert against the entire render output, modifying portions of the assertion itself as needed.</p>
<p>To use Assertion Templates, first import the module:</p>
<pre class=" language-ts"><code class="language-ts"><span class="token keyword">import</span> assertionTemplate <span class="token keyword">from</span> <span class="token string">'@dojo/framework/testing/assertionTemplate'</span><span class="token punctuation">;</span>
</code></pre>
<p>In your tests, you can then write a base assertion which would be the default render state of your widget.</p>
<p>Given the following widget:</p>
<pre class=" language-ts"><code class="language-ts"><span class="token keyword">class</span> <span class="token class-name">NumberWidget</span> <span class="token keyword">extends</span> <span class="token class-name">WidgetBase</span><span class="token operator">&lt;</span><span class="token punctuation">{</span> num<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token keyword">number</span> <span class="token punctuation">}</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> num <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>properties<span class="token punctuation">;</span>
        <span class="token keyword">const</span> message <span class="token operator">=</span> num <span class="token operator">===</span> undefined <span class="token operator">?</span> <span class="token string">'no number passed'</span> <span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`the number </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>num<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
            <span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span> message <span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>The base assertion might look like:</p>
<pre class=" language-ts"><code class="language-ts"><span class="token keyword">const</span> baseAssertion <span class="token operator">=</span> <span class="token function">assertionTemplate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
        <span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string">'~key'</span><span class="token punctuation">:</span> <span class="token string">'message'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span> <span class="token string">'no number passed'</span> <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>and in a test would look like:</p>
<pre class=" language-ts"><code class="language-ts"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should render no number passed when no number is passed as a property'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> h <span class="token operator">=</span> <span class="token function">harness</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token function">w</span><span class="token punctuation">(</span>NumberWidget<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    h<span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span>baseAssertion<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Now let’s see how we would test the output when the <code>num</code> property gets passed to the <code>NumberWidget</code>:</p>
<pre class=" language-ts"><code class="language-ts"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should render the number when a number is passed as a property'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> numberAssertion <span class="token operator">=</span> baseAssertion<span class="token punctuation">.</span><span class="token function">setChildren</span><span class="token punctuation">(</span><span class="token string">'~message'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span> <span class="token string">'the number 5'</span> <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> h <span class="token operator">=</span> <span class="token function">harness</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token function">w</span><span class="token punctuation">(</span>NumberWidget<span class="token punctuation">,</span> <span class="token punctuation">{</span> num<span class="token punctuation">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    h<span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span>numberAssertion<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Here we’re using the <code>setChildren()</code> API on the <code>baseAssertion</code>, and we’re using a special <code>~</code> selector to find a node with a key of <code>~message</code>. The <code>~key</code> property is a special property on Assertion Templates and will get erased at assertion time, so it doesn’t show up when matching the renders. This approach allows you to decorate the Assertion Templates to easily select nodes, without having to augment the actual widgets render function.</p>
<p>Once we have the <code>message</code> node we then set the children to the expected <code>the number 5</code>, and use the resulting template in <code>h.expect</code>. It’s important to note Assertion Templates always return a new Assertion Template when setting a value, this ensures you don’t accidentally mutate an existing template (potentially causing other tests to fail), and allows you to compose layered Templates incrementally building on each other.</p>
<h3 id="Improved-Stores-Middleware"><a href="#Improved-Stores-Middleware" class="headerlink" title="Improved Stores Middleware"></a>Improved Stores Middleware</h3><p>Middleware for Dojo stores has always gotten executed after a process has completed or throws an error, enabling users to make decisions based on the result and perform some additional actions. However, this was limiting middleware from running before or effectively wrapping a process. Version 5 of Dojo introduces <code>before</code> and <code>after</code> middleware to perform such actions around processes completely. <a href="https://github.com/dojo/framework/blob/master/src/stores/README.md#middleware" target="_blank" rel="noopener">Read more on the <code>@dojo/framework/stores</code> readme</a>.</p>
<p>This addition of <code>before</code> and <code>after</code> middleware is a breaking change. However, if your application was already using <code>createCallbackDecorator</code> to create your middleware, then your application should continue to work with your application in version 5 of Dojo application as the <code>createCallbackDecorator</code> function has been adapted to transform existing middleware API to the new API.</p>
<h3 id="Improvements-for-serve-and-watch-options-in-dojo-cli-build-app"><a href="#Improvements-for-serve-and-watch-options-in-dojo-cli-build-app" class="headerlink" title="Improvements for serve and watch options in @dojo/cli-build-app"></a>Improvements for <code>serve</code> and <code>watch</code> options in <code>@dojo/cli-build-app</code></h3><p>The <code>@dojo/cli-build-app</code> command includes a number improvements for running a development server:</p>
<ul>
<li>The previous <code>watch</code> modes, <code>memory</code> and <code>file</code> have been consolidated into a unified <code>watch</code> option</li>
<li>Rebuilds your application when you make any changes within the project directory, not limited to <code>src</code> and <code>test</code> directories.</li>
<li>Live reload when the application is rebuilt during <code>watch</code> and running the development server using <code>serve</code></li>
<li>Customized live reload <code>client</code> that does not affect your built application bundles</li>
<li>Conditionally loads the live reload <code>client</code> only when using the <code>serve</code> option</li>
<li>Fallback to default <code>index.html</code> and rewrite resources when using the <code>StateHistory</code> history manager with <code>@dojo/framework/routing</code></li>
</ul>
<h3 id="Extended-TypeScript-Support"><a href="#Extended-TypeScript-Support" class="headerlink" title="Extended TypeScript Support"></a>Extended TypeScript Support</h3><p>Dojo now supports TypeScript versions from 2.6.x to 3.2.x, please see our <a href="https://github.com/dojo/framework#typescript-and-dojo-compatibility-matrix" target="_blank" rel="noopener">TypeScript and Dojo compatibility matrix</a> for more information.</p>
<h3 id="Update-to-Dojo-5-0-0"><a href="#Update-to-Dojo-5-0-0" class="headerlink" title="Update to Dojo 5.0.0"></a>Update to Dojo 5.0.0</h3><p>Visit the <a href="https://github.com/dojo/framework/blob/master/docs/V5-Migration-Guide.md" target="_blank" rel="noopener">Dojo version 5 migration guide</a> for detailed information and guidance on updating your application. Updgrading from 4.0.x to 5.0.0 should require running one command for most users.</p>
<p>After installing the latest version of the <code>@dojo/cli-upgrade-app</code>, run the following command:</p>
<pre class=" language-sh"><code class="language-sh">dojo upgrade app
</code></pre>
<h3 id="Beyond-version-5"><a href="#Beyond-version-5" class="headerlink" title="Beyond version 5"></a>Beyond version 5</h3><p>We are working on a detailed roadmap for the next major release, however, in the meantime check out our <a href="https://github.com/dojo/meta/wiki/Roadmap#future-ideas" target="_blank" rel="noopener">future roadmap</a> for ideas we want to investigate over the next 12 months.</p>
<h3 id="Support"><a href="#Support" class="headerlink" title="Support"></a>Support</h3><p>See the <a href="https://github.com/dojo/framework/releases/tag/v5.0.0" target="_blank" rel="noopener">release notes</a> for more details on version 5 of Dojo.</p>
<p>Love what we’re doing or having a problem? We ❤️ our community. Reach out to us on <a href="https://discord.gg/M7yRngE" target="_blank" rel="noopener">Discord</a>, check out our <a href="https://dojo.io/community/">roadmap</a> and see where we are heading with Dojo,, and try out the new <a href="https://codesandbox.io/s/github/dojo/dojo-codesandbox-template" target="_blank" rel="noopener">Dojo on CodeSandbox</a>. We look forward to your feedback.</p>

					
				</div>
				<footer class="article-footer">
					
					
				</footer>
			</div>
			
				
<hr>
<nav id="article-nav" class="uk-child-width-1-2@s uk-text-center uk-grid-match uk-margin-top" uk-grid>

	
	
		<div class="uk-card uk-card-hover uk-card-body">
			<strong class="uk-text-small">Previous Post</strong>
			<h4 class="uk-h4 uk-padding-remove-top uk-margin-small-top"><a href="/blog/2018/10/15/2018-10-15-Version-4-Dojo/" id="article-nav-older" class="article-nav-link-wrap">Announcing Version 4 of Dojo</a></h4>
		</div>
	
</nav>

			
		</article>

		
	</div>
</div>

<div id="mobile-sidebar" class="sidebar-left" uk-offcanvas>
	<div class="uk-offcanvas-bar">
		<div>
			<ul class="uk-nav" data-uk-nav>
	<li><a class="navbar-item" href="/docs.html">Docs</a></li>
<li><a class="navbar-item " href="/tutorials">Tutorials</a></li>
<li><a class="navbar-item" href="/blog">Blog</a></li>
<li><a class="navbar-item" href="/community">Community</a></li>
</ul>

		</div>
	</div>
</div>

				</div>
				<footer class="footer uk-text-small uk-text-muted uk-container-expanded">
	<span>&copy; 2018 JS Foundation, All Rights Reserved.</span>
</footer>

			</div>
			
		</div>
		


<script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.0-rc.10/js/uikit.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.0-rc.10/js/uikit-icons.min.js"></script>
<script defer src="https://use.fontawesome.com/releases/v5.0.12/js/all.js" integrity="sha384-Voup2lBiiyZYkRto2XWqbzxHXwzcm4A5RfdfG6466bu5LqjwwrjXCMBQBLMWh7qR" crossorigin="anonymous"></script>

	</body>
</html>
