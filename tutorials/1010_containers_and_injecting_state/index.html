<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
	<meta charset="utf-8">
	

	<title>State management | Dojo</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta property="”og:image”" content="”https://dojo.io/images/og.jpg”">
	<meta name="description" content="State managementOverviewModern web applications are often required to manage complex state models which can involve fetching data from a remote service or multiple widgets requiring the same slices o">
<meta property="og:type" content="website">
<meta property="og:title" content="State management">
<meta property="og:url" content="https://dojo.io/tutorials/1010_containers_and_injecting_state/index.html">
<meta property="og:site_name" content="Dojo">
<meta property="og:description" content="State managementOverviewModern web applications are often required to manage complex state models which can involve fetching data from a remote service or multiple widgets requiring the same slices o">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-03-22T14:47:35.862Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="State management">
<meta name="twitter:description" content="State managementOverviewModern web applications are often required to manage complex state models which can involve fetching data from a remote service or multiple widgets requiring the same slices o">
<meta name="twitter:creator" content="@https:&#x2F;&#x2F;twitter.com&#x2F;dojo">
	
		<link rel="alternate" href="/atom.xml" title="Dojo" type="application/atom+xml">
	
	
		<link rel="icon" href="/images/favicons/favicon.ico">
	
	<link rel="stylesheet" href="/css/main.css">
	
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-3242977-15', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


<link rel="stylesheet" href="/css/prism-vs.css" type="text/css"></head>
</html>
	<body class="body-tutorial
">
		<div class="page-wrapper">
			<div uk-sticky="sel-target: .uk-navbar-container; cls-active: uk-navbar-sticky">
	<div class="uk-container uk-container-expand uk-navbar-container">
		<nav class="uk-navbar" uk-navbar>
			<div class="uk-navbar-left">
				<ul class="uk-navbar-nav">
					<li><a href="#sidebar-nav" uk-icon="icon: menu" class="navbar-item uk-hidden@m" uk-toggle="target: #mobile-sidebar"></a></li>
					<li><a href="/" class="navbar-item"><img src="/images/logos/dojo2-logo-white.svg" class="uk-logo site-logo" alt="Dojo"></a></li>
				</ul>
			</div>
			<div class="uk-navbar-right uk-visible@m">
				<ul class="uk-navbar-nav">
					<li><a class="navbar-item" href="/docs.html">Docs</a></li>
<li><a class="navbar-item " href="/tutorials">Tutorials</a></li>
<li><a class="navbar-item" href="/blog">Blog</a></li>
<li><a class="navbar-item" href="/community">Community</a></li>
				</ul>
			</div>
		</nav>
	</div>
</div>

			<div class="content-wrapper">
				<div class="page-content">
					<section class="section">
	<div class="container">
		<div class="uk-offcanvas-content has-sidebar-left">
			<div class="sidebar-left uk-visible@m">
				<ul class="uk-nav uk-nav-primary">
	<h3>Tutorials</h3>
	<li class="uk-nav-header">Getting Started</li>
	<li class="uk-nav-divider"></li>

	
			<li class><a href="/tutorials/000_local_installation/">Dojo local installation</a></li>
	
			<li class><a href="/tutorials/001_static_content/">Your first Dojo application</a></li>
	
			<li class><a href="/tutorials/002_creating_an_application/">Components of a Dojo application</a></li>
	
			<li class><a href="/tutorials/003_creating_widgets/">Creating widgets</a></li>
	
			<li class><a href="/tutorials/004_user_interactions/">Responding to events</a></li>
	
			<li class><a href="/tutorials/005_form_widgets/">Form widgets</a></li>
	
			<li class><a href="/tutorials/006_deploying_to_production/">Deploying to production</a></li>
	
			<li class="uk-nav-header">Advanced</li>
			<li class="uk-nav-divider"></li>
	
			<li class><a href="/tutorials/007_theming/">Theming</a></li>
	
			<li class><a href="/tutorials/008_animations/">Web Animations</a></li>
	
			<li class="uk-active"><a href="/tutorials/1010_containers_and_injecting_state/">State management</a></li>
	
			<li class><a href="/tutorials/1015_form_validation/">Form validation</a></li>
	
			<li class><a href="/tutorials/1020_registries/">Registry</a></li>
	
			<li class><a href="/tutorials/1030_routing/">Routing</a></li>
	
			<li class><a href="/tutorials/1050_development_environment/">Setting up a development environment</a></li>
	
			<li class><a href="/tutorials/1060_data_driven_widgets/">Data-driven widgets</a></li>
	
			<li class><a href="/tutorials/1070_custom_elements/">Creating Custom Elements</a></li>
	
</ul>

			</div>
			<div class="uk-section uk-section-default">
				<div class="uk-container uk-container-small uk-position-relative">
					<section class="tutorial hidden hiding">
<h1 id="State-management"><a href="#State-management" class="headerlink" title="State management"></a>State management</h1><h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>Modern web applications are often required to manage complex state models which can involve fetching data from a remote service or multiple widgets requiring the same slices of state. While Dojo’s widgets can manage application state, encapsulation and a clean separation of concerns may be lost if widgets manage their own visual representations, listen for interactions from the user, manage their children, and keep track of state information. Additionally, using widgets to pass state through an application often forces the widgets to be aware of state information for the sole purpose of passing that data down to their children. To allow widgets to remain focused on their primary roles of providing a visual representation of themselves and listening for user interactions, Dojo provides a mechanism using the <code>Registry</code> and <code>Container</code> classes, that is designed to coordinate an application’s external state and connect and map this state to properties.</p>
<p>In this tutorial, we will start with an application that is managing its state in the widgets themselves. We will then extract all of the state-related code out of the widgets and inject external state as properties only into widgets as is needed.</p>
<p>You can open the <a href="https://codesandbox.io/s/github/dojo/dojo.io/tree/master/site/source/tutorials/1010_containers_and_injecting_state/demo/initial/biz-e-corp" target="_blank" rel="noopener">tutorial on codesandbox.io</a> or <a href="../assets/1010_containers_and_injecting_state-initial.zip">download</a> the demo project and run <code>npm install</code> to get started.</p>
<h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><p>This tutorial assumes that you have gone through the <a href="../001_static_content">beginner tutorial</a> series.</p>
</section><section class="tutorial hidden hiding">
<h2 id="Creating-an-application-context"><a href="#Creating-an-application-context" class="headerlink" title="Creating an application context"></a>Creating an application context</h2><div class="task">Create a class to manage application state.</div>
<p>To begin our tutorial, let’s review the initial version of <code>App</code>:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> WidgetBase <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@dojo/framework/widget-core/WidgetBase'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> v<span class="token punctuation">,</span> w <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@dojo/framework/widget-core/d'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Banner <span class="token keyword">from</span> <span class="token string">'./Banner'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> WorkerForm<span class="token punctuation">,</span> <span class="token punctuation">{</span> WorkerFormData <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./WorkerForm'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> WorkerProperties <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Worker'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> WorkerContainer <span class="token keyword">from</span> <span class="token string">'./WorkerContainer'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">WidgetBase</span> <span class="token punctuation">{</span>
	<span class="token keyword">private</span> _newWorker<span class="token punctuation">:</span> Partial<span class="token operator">&lt;</span>WorkerFormData<span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token keyword">private</span> _workerData<span class="token punctuation">:</span> WorkerProperties<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
		<span class="token punctuation">{</span>
			firstName<span class="token punctuation">:</span> <span class="token string">'Tim'</span><span class="token punctuation">,</span>
			lastName<span class="token punctuation">:</span> <span class="token string">'Jones'</span><span class="token punctuation">,</span>
			email<span class="token punctuation">:</span> <span class="token string">'tim.jones@bizecorp.org'</span><span class="token punctuation">,</span>
			tasks<span class="token punctuation">:</span> <span class="token punctuation">[</span>
				<span class="token string">'6267 - Untangle paperclips'</span><span class="token punctuation">,</span>
				<span class="token string">'4384 - Shred documents'</span><span class="token punctuation">,</span>
				<span class="token string">'9663 - Digitize 1985 archive'</span>
			<span class="token punctuation">]</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span>
			firstName<span class="token punctuation">:</span> <span class="token string">'Alicia'</span><span class="token punctuation">,</span>
			lastName<span class="token punctuation">:</span> <span class="token string">'Fitzgerald'</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span>
			firstName<span class="token punctuation">:</span> <span class="token string">'Hans'</span><span class="token punctuation">,</span>
			lastName<span class="token punctuation">:</span> <span class="token string">'Mueller'</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">]</span><span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token function">_addWorker</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>_workerData <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_workerData<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_newWorker<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>_newWorker <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">invalidate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">private</span> <span class="token function">_onFormInput</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> Partial<span class="token operator">&lt;</span>WorkerFormData<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>_newWorker <span class="token operator">=</span> <span class="token punctuation">{</span>
			<span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>_newWorker<span class="token punctuation">,</span>
			<span class="token operator">...</span>data
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">invalidate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">protected</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
			<span class="token function">w</span><span class="token punctuation">(</span>Banner<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			<span class="token function">w</span><span class="token punctuation">(</span>WorkerForm<span class="token punctuation">,</span> <span class="token punctuation">{</span>
				formData<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_newWorker<span class="token punctuation">,</span>
				onFormInput<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_onFormInput<span class="token punctuation">,</span>
				onFormSave<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_addWorker
			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			<span class="token function">w</span><span class="token punctuation">(</span>WorkerContainer<span class="token punctuation">,</span> <span class="token punctuation">{</span>
				workerData<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_workerData
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Most of this widget is dedicated to holding and managing the <code>WorkerData</code> in the application. Notice, however, that it never actually uses that data itself. <code>App</code> is only containing the state and passing it to the children as required via properties. Lifting up state to the highest common widget in the tree is a valid pattern, but as an application’s state grows in size and complexity, it is often desirable to decouple this from widgets. In larger applications, the <code>App</code> class would become complicated and more difficult to maintain due to the additional state information that it would be required to track. Since the state information is not a primary concern of the <code>App</code> class, let’s refactor it out of <code>App</code> and into a new <code>ApplicationContext</code> class that extends the base <code>Injector</code>.</p>
<div class="instruction">Add the following to the existing <code>ApplicationContext.ts</code> file in the <code>src</code> directory</div>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> deepAssign <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@dojo/framework/core/util'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> WorkerProperties <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./widgets/Worker'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> WorkerFormData <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./widgets/WorkerForm'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">ApplicationContext</span> <span class="token punctuation">{</span>

	<span class="token keyword">private</span> _workerData<span class="token punctuation">:</span> WorkerProperties<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

	<span class="token keyword">private</span> _formData<span class="token punctuation">:</span> Partial<span class="token operator">&lt;</span>WorkerFormData<span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token keyword">private</span> _invalidator<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span>

	<span class="token function">constructor</span><span class="token punctuation">(</span>invalidator<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">,</span> workerData<span class="token punctuation">:</span> WorkerProperties<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>_workerData <span class="token operator">=</span> workerData<span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>_invalidator <span class="token operator">=</span> invalidator<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">get</span> <span class="token function">workerData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> WorkerProperties<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_workerData<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">get</span> <span class="token function">formData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Partial<span class="token operator">&lt;</span>WorkerFormData<span class="token operator">></span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_formData<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token function">formInput</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> Partial<span class="token operator">&lt;</span>WorkerFormData<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>_formData <span class="token operator">=</span> <span class="token function">deepAssign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_formData<span class="token punctuation">,</span> input<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_invalidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token function">submitForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>_workerData <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>_workerData<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_formData <span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>_formData <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_invalidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<article class="aside"><strong class="label">Invalidations</strong><p>Dojo Widgets can invoke <code>invalidate()</code> directly, however, injector factories receive an <code>invalidator</code> that can be called to ensure that all connected widgets are invalidated</p></article>
<p>The code begins by importing some modules, including the <code>WorkerProperties</code> and <code>WorkerFormData</code> interfaces defined in the <code>Worker</code> and <code>WorkerForm</code> modules. These two interfaces define the shape of state that the <code>ApplicationContext</code> manages.</p>
<p>The <code>ApplicationContext</code> contains the application state information. The constructor accepts two parameters, an <code>invalidator</code> that is called when the internal state changes and the initial state.</p>
<p><code>ApplicationContext</code> also has two private fields, <code>_workerData</code> and <code>_formData</code>, which contain the state, and two accessor methods to retrieve these fields.</p>
<pre class="language-javascript"><code class="language-javascript">
<span class="token keyword">public</span> <span class="token function">formInput</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> Partial<span class="token operator">&lt;</span>WorkerFormData<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>_formData <span class="token operator">=</span> <span class="token function">deepAssign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_formData<span class="token punctuation">,</span> input<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_invalidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token function">submitForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>_workerData <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>_workerData<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_formData <span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>_formData <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_invalidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>The <code>formInput</code> method provides the same functionality as the <code>_onFormInput</code> method in the <code>App</code> class and the <code>submitForm</code> method is analogous to the <code>_addWorker</code> method from the <code>App</code> class. The implementations vary slightly as the <code>ApplicationContext</code> has dedicated fields to store the state information. Also, since the <code>ApplicationContext</code> is not a widget, it cannot call <code>invalidate();</code> to schedule a re-render. Instead the instance needs to call the <code>invalidator</code> function passed in and stored on construction.</p>
<p>Notice that the <code>ApplicationContext</code> does not contain any code to load state information. Currently its only role is only to manage the application’s state provided on initialization via its <code>constructor</code>. However as the requirements for the application become more advanced, the <code>ApplicationContext</code> could make requests to fetch and modify data from a remote service or local storage mechanism.</p>
<p>Now that we have moved state management to a dedicated module, we need a way to register the state and connect it to sections of our application. We will do this by creating a registry and registering the <code>ApplicationContext</code> injector.</p>
</section><section class="tutorial hidden hiding">
<h2 id="Injectors"><a href="#Injectors" class="headerlink" title="Injectors"></a>Injectors</h2><div class="task">Register an injector factory that will allow state to be injected into widgets.</div>
<p>Currently, the application’s <code>main</code> module is only responsible for creating the <code>Projector</code>, which provides the bridge between the application code and the DOM.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> renderer <span class="token keyword">from</span> <span class="token string">'@dojo/framework/widget-core/vdom'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> w <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@dojo/framework/widget-core/d'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./widgets/App'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> r <span class="token operator">=</span> <span class="token function">renderer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">w</span><span class="token punctuation">(</span>App<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
r<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token punctuation">{</span> domNode<span class="token punctuation">:</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'my-app'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> HTMLElement <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Now, we need to:</p>
<ol>
<li>Create a <code>registry</code> and then define an injector factory that creates the <code>ApplicationContext</code> passing the invalidator and initial state. The injector factory returns a function that returns the <code>ApplicationContext</code> instance.</li>
<li>To make the <code>registry</code> available within the widget tree, we need to pass the <code>registry</code> as a property to the <code>projector</code></li>
</ol>
<div class="instruction">Import the <code>ApplicationContext</code> module and add this code to the <code>main</code> module:</div>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> ApplicationContext <span class="token keyword">from</span> <span class="token string">'./ApplicationContext'</span><span class="token punctuation">;</span>
</code></pre>
<article class="aside"><strong class="label">Loading data</strong><p>In a real-world application, this data would probably be loaded via a call to a web service or a local data store. To learn more, take a look at the <a href="../comingsoon.html">stores tutorial</a>.</p></article>
<p>The state stored in the <code>ApplicationContext</code> is the same data that was used in the previous version of the <code>App</code> module to initialize the <code>WorkerProperties</code>, but it is now decoupled into an isolated module that helps to understand and maintain the application. In general, the <code>main</code> module of an application should be concerned with initializing application-wide state. Also, as previously mentioned, the <code>App</code> class only needed to manage the <code>WorkerProperties</code> state so that it could coordinate change to its children.</p>
<p>Now we need to create the registry, create the injector factory that creates and returns the <code>ApplicationContext</code> instance injector, and finally make the registry available to the widget tree.</p>
<div class="instruction">Add the <code>Registry</code> import to the <code>main</code> module.</div>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Registry <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@dojo/framework/widget-core/Registry'</span><span class="token punctuation">;</span>
</code></pre>
<div class="instruction">Now, create an injector factory that creates and returns the application context</div>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> registry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Registry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
registry<span class="token punctuation">.</span><span class="token function">defineInjector</span><span class="token punctuation">(</span><span class="token string">'app-state'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>invalidator<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> applicationContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApplicationContext</span><span class="token punctuation">(</span>invalidator<span class="token punctuation">,</span> <span class="token punctuation">[</span>
		<span class="token punctuation">{</span>
			firstName<span class="token punctuation">:</span> <span class="token string">'Tim'</span><span class="token punctuation">,</span>
			lastName<span class="token punctuation">:</span> <span class="token string">'Jones'</span><span class="token punctuation">,</span>
			email<span class="token punctuation">:</span> <span class="token string">'tim.jones@bizecorp.org'</span><span class="token punctuation">,</span>
			tasks<span class="token punctuation">:</span> <span class="token punctuation">[</span>
				<span class="token string">'6267 - Untangle paperclips'</span><span class="token punctuation">,</span>
				<span class="token string">'4384 - Shred documents'</span><span class="token punctuation">,</span>
				<span class="token string">'9663 - Digitize 1985 archive'</span>
			<span class="token punctuation">]</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span>
			firstName<span class="token punctuation">:</span> <span class="token string">'Alicia'</span><span class="token punctuation">,</span>
			lastName<span class="token punctuation">:</span> <span class="token string">'Fitzgerald'</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span>
			firstName<span class="token punctuation">:</span> <span class="token string">'Hans'</span><span class="token punctuation">,</span>
			lastName<span class="token punctuation">:</span> <span class="token string">'Mueller'</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> applicationContext<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<article class="aside"><strong class="label">Registry</strong><p>The registry provides a way to register a widget via a label, making it accessible to other parts of the application. You can learn more in the <a href="../1020_registries/">registry tutorial</a>.</p></article>
<p>The first statement creates a <code>registry</code> where the application context can be registered. The second statement registers an injector factory that creates the <code>ApplicationContext</code> instance passing in the <code>invalidator</code> function passed to the factory. The factory creates an injector function that returns the created <code>ApplicationContext</code> instance.</p>
<div class="instruction">Pass the registry to the renderer when mounting</div>
<p>We need to pass the <code>registry</code> to the <code>renderer</code> as an option on the <code>mount</code> function. This ensures that the <code>registry</code> instance is available for all widget and container instances.</p>
<pre class="language-javascript"><code class="language-javascript">r<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token punctuation">{</span> domNode<span class="token punctuation">:</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'my-app'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> HTMLElement<span class="token punctuation">,</span> registry <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Now that the <code>ApplicationContext</code> injector factory is defined, and the <code>registry</code> gets set on the <code>projector</code>, it is time to create the components that will use it. In the next section, we will create a non-visual widget called a <code>Container</code> that will allow injecting state into the <code>WorkerForm</code> and <code>WorkerContainer</code> widgets.</p>
</section><section class="tutorial hidden hiding">
<h2 id="Creating-state-containers"><a href="#Creating-state-containers" class="headerlink" title="Creating state containers"></a>Creating state containers</h2><div class="task">Create <code>Containers</code> that will allow state to be injected into widgets</div>
<p>On their own, the injector factories defined on the <code>registry</code> are not able to help us very much because widgets expect state to be passed to them via properties. Therefore an <code>injector</code> must be connected to interested widgets in order for their state to be mapped to <code>properties</code> that widgets can consume by using a <code>Container</code>. <code>Containers</code> are designed to coordinate the injection - they connect <code>injectors</code> to widgets and return <code>properties</code> from the <code>injector</code>‘s state which are passed to the connected widgets.</p>
<p>Normally, a separate <code>Container</code> is created for each widget that needs to have <code>properties</code> injected. In the demo application, we have two widgets that rely on application state - <code>WorkerContainer</code> and <code>WorkerForm</code>.</p>
<p>Let’s start with the <code>WorkerContainer</code>. As a best practice, you should give your containers the same name as their respective widgets, with a <code>Container</code> suffix.</p>
<p>E.g. Widget name: <code>Foo</code><br>container name ‘FooContainer’. To keep things organized, they are also stored in a different directory - <code>containers</code>.</p>
<div class="instruction">Add the following imports to the <code>WorkerContainerContainer</code> in the <code>containers</code> directory</div>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Container <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@dojo/framework/widget-core/Container'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> ApplicationContext <span class="token keyword">from</span> <span class="token string">'./../ApplicationContext'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> WorkerContainer<span class="token punctuation">,</span> <span class="token punctuation">{</span> WorkerContainerProperties <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./../widgets/WorkerContainer'</span><span class="token punctuation">;</span>
</code></pre>
<ul>
<li>The first <code>import</code> gives the module access to the <code>Container</code> factory function which will be used to construct the container.</li>
<li>The second <code>import</code> allows the module to use the <code>ApplicationContext</code> to extract state</li>
<li>The third import enables the <code>WorkerContainerProperties</code> to receive properties from its parent, and wrap the <code>WorkerContainer</code> class with the <code>container</code>.</li>
</ul>
<p>Next, we need to address the fact that the container has two places to get properties from - its parent widget and the <code>ApplicationContext</code>. To tell the container how to manage this, we will create a function called <code>getProperties</code>.</p>
<div class="instruction">Add the <code>getProperties</code> function to the <code>WorkerContainerContainer</code> module.</div>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">getProperties</span><span class="token punctuation">(</span>inject<span class="token punctuation">:</span> ApplicationContext<span class="token punctuation">,</span> properties<span class="token punctuation">:</span> any<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token punctuation">{</span> workerData<span class="token punctuation">:</span> inject<span class="token punctuation">.</span>workerData <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>The <code>getProperties</code> function receives two parameters. The first is the <code>payload</code> of the <code>injector</code> instance returned by the <code>injector</code> function returned by the registered factory. The second is the <code>properties</code> that have been passed to the container via the normal mechanism, <code>w(Container, properties)</code>. The properties will implement the properties interface defined by the wrapped widget (for example <code>WorkerContainerProperties</code>). The <code>getProperties</code> function must then return an object that holds the properties that will be passed to the widget itself. In this example, we are ignoring the properties provided by the parent and returning the <code>workerData</code> stored by the <code>ApplicationContext</code>. More advanced use cases where both sources are used to generate the properties are also possible.</p>
<div class="instruction">Finish the <code>WorkerContainerContainer</code> by adding the following code.</div>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> WorkerContainerContainer <span class="token operator">=</span> <span class="token function">Container</span><span class="token punctuation">(</span>WorkerContainer<span class="token punctuation">,</span> <span class="token string">'app-state'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> getProperties <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> WorkerContainerContainer<span class="token punctuation">;</span>
</code></pre>
<p>These final lines define the actual <code>WorkerContainerContainer</code> class and exports it. The <code>Container</code> function creates the class by accepting three parameters:</p>
<ul>
<li>The widget’s class definition (alternatively, a widget’s registry key can be used)</li>
<li>The registry key for the <code>Injector</code></li>
<li>An object literal that provides the mapping functions used to reconcile the two sets of properties and children that the container can receive (one from the <code>Injector</code> and one from the parent widget). The returned class is also a widget as it descends from <code>WidgetBase</code> and therefore may be used just like any other widget.</li>
</ul>
<p>The other container that we need is the <code>WorkerFormContainer</code>.</p>
<div class="instruction">Add the following code to the <code>WorkerFormContainer</code> module in the <code>containers</code> sub-package.</div>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Container <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@dojo/framework/widget-core/Container'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> ApplicationContext <span class="token keyword">from</span> <span class="token string">'./../ApplicationContext'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> WorkerForm<span class="token punctuation">,</span> <span class="token punctuation">{</span> WorkerFormProperties <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./../widgets/WorkerForm'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">getProperties</span><span class="token punctuation">(</span>inject<span class="token punctuation">:</span> ApplicationContext<span class="token punctuation">,</span> properties<span class="token punctuation">:</span> any<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token punctuation">{</span>
		formData<span class="token punctuation">,</span>
		formInput<span class="token punctuation">:</span> onFormInput<span class="token punctuation">,</span>
		submitForm<span class="token punctuation">:</span> onFormSave
	<span class="token punctuation">}</span> <span class="token operator">=</span> inject<span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token punctuation">{</span>
		formData<span class="token punctuation">,</span>
		onFormInput<span class="token punctuation">:</span> onFormInput<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>inject<span class="token punctuation">)</span><span class="token punctuation">,</span>
		onFormSave<span class="token punctuation">:</span> onFormSave<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>inject<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> WorkerFormContainer <span class="token operator">=</span> <span class="token function">Container</span><span class="token punctuation">(</span>WorkerForm<span class="token punctuation">,</span> <span class="token string">'app-state'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> getProperties <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> WorkerFormContainer<span class="token punctuation">;</span>
</code></pre>
<p>This module is almost identical to the <code>WorkerContainerContainer</code> except for additional properties that are required by the <code>WorkerForm</code> to allow it to respond to user interactions with the form. The <code>ApplicationContext</code> contains two methods for managing these events - <code>onFormInput</code> and <code>onFormSave</code>. These methods need to be passed into the <code>WorkerForm</code> to handle the events, but they need to execute in the context of the <code>ApplicationContext</code>. To handle this, <code>bind</code> is called on each of the methods to explicitly set their execution contexts.</p>
<p>At this point, we have created the <code>ApplicationContext</code> to manage state, an <code>ApplicationContext</code> injector factory to inject state into the application’s widgets, and <code>Containers</code> to manage how properties and children from the injector and parent widgets are combined. In the next section, we will integrate these components into our application.</p>
</section><section class="tutorial hidden hiding">
<h2 id="Using-state-containers"><a href="#Using-state-containers" class="headerlink" title="Using state containers"></a>Using state containers</h2><div class="task">Integrate containers into an application.</div>
<p>As mentioned in the previous section, <code>Container</code> is a higher order component that extends <code>WidgetBase</code> and returns the wrapped widget and injected <code>properties</code> from the <code>render</code>. As such, it can be used just like any other widget. In our demo application, we can take advantage of its extension of <code>WidgetBase</code> by simply replacing the <code>WorkerForm</code> and <code>WorkerContainer</code> with their container equivalents.</p>
<div class="instruction">Replace the imports in the <code>App</code> module with the following.</div>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> WidgetBase <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@dojo/framework/widget-core/WidgetBase'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> v<span class="token punctuation">,</span> w <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@dojo/framework/widget-core/d'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Banner <span class="token keyword">from</span> <span class="token string">'./Banner'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> WorkerContainerContainer <span class="token keyword">from</span> <span class="token string">'./../containers/WorkerContainerContainer'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> WorkerFormContainer <span class="token keyword">from</span> <span class="token string">'./../containers/WorkerFormContainer'</span><span class="token punctuation">;</span>
</code></pre>
<p>There are two major changes to the <code>App</code> module’s imports. First, the widgets (<code>WorkerForm</code> and <code>WorkerContainer</code>) have been replaced by their container equivalents (<code>WorkerFormContainer</code> and <code>WorkerContainerContainer</code>). Second, all of the interfaces, <code>WorkerFormData</code>, and <code>WorkerProperties</code> have been removed. These are no longer needed since the <code>App</code> class no longer needs to manage state.</p>
<p>Also, the property and methods within <code>App</code> that are setting and managing state can be removed.</p>
<div class="instruction">Remove the following code from the <code>App</code> class.</div>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">private</span> _newWorker<span class="token punctuation">:</span> Partial<span class="token operator">&lt;</span>WorkerFormData<span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">private</span> _workerData<span class="token punctuation">:</span> WorkerProperties<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
	<span class="token punctuation">{</span>
		firstName<span class="token punctuation">:</span> <span class="token string">'Tim'</span><span class="token punctuation">,</span>
		lastName<span class="token punctuation">:</span> <span class="token string">'Jones'</span><span class="token punctuation">,</span>
		email<span class="token punctuation">:</span> <span class="token string">'tim.jones@bizecorp.org'</span><span class="token punctuation">,</span>
		tasks<span class="token punctuation">:</span> <span class="token punctuation">[</span>
			<span class="token string">'6267 - Untangle paperclips'</span><span class="token punctuation">,</span>
			<span class="token string">'4384 - Shred documents'</span><span class="token punctuation">,</span>
			<span class="token string">'9663 - Digitize 1985 archive'</span>
		<span class="token punctuation">]</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span>
		firstName<span class="token punctuation">:</span> <span class="token string">'Alicia'</span><span class="token punctuation">,</span>
		lastName<span class="token punctuation">:</span> <span class="token string">'Fitzgerald'</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span>
		firstName<span class="token punctuation">:</span> <span class="token string">'Hans'</span><span class="token punctuation">,</span>
		lastName<span class="token punctuation">:</span> <span class="token string">'Mueller'</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">private</span> <span class="token function">_addWorker</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>_workerData <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_workerData<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_newWorker<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>_newWorker <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">invalidate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token function">_onFormInput</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> Partial<span class="token operator">&lt;</span>WorkerFormData<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>_newWorker <span class="token operator">=</span> <span class="token punctuation">{</span>
		<span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>_newWorker<span class="token punctuation">,</span>
		<span class="token operator">...</span>data
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">invalidate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>The final change to <code>App</code> is to update the <code>render</code> method to use the containers. Since the containers already know how to manage their state and respond to events, no properties need to be passed directly to the <code>Container</code> by the <code>App</code> widget.</p>
<div class="instruction">Replace the <code>render</code> method with the following code.</div>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">protected</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
		<span class="token function">w</span><span class="token punctuation">(</span>Banner<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token function">w</span><span class="token punctuation">(</span>WorkerFormContainer<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token function">w</span><span class="token punctuation">(</span>WorkerContainerContainer<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>With this last change, the <code>App</code> class is now only nine lines of code. All of the state management logic is still part of the application, but it has been refactored out of the <code>App</code> class to create a more efficient application architecture.</p>
<p>Notice that the <code>WorkerForm</code> and <code>WorkerContainer</code> widgets were not changed at all! This is an important thing to keep in mind when designing widgets - a widget should never be tightly coupled to the source of its properties. By keeping the containers and widgets separate, we have helped to ensure that each widget or container has a narrowly defined set of responsibilities, creating a cleaner separation of concerns within our widgets and containers.</p>
<p>At this point, you should reload your page and verify the application is working.</p>
</section><section class="tutorial hidden hiding">
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>Since Dojo widgets are TypeScript classes, they are capable of filling a large number of roles, including state management. With complex widgets, however, combining the responsibilities to manage the widget’s visual representation as well as the state of its children can make them difficult to manage and test. Dojo defines the <code>Registry</code> and <code>Container</code> classes as a way to externalize state management from the app and centralize that management into mechanisms that are designed specifically to fill that role.</p>
<p>If you would like, you can open the completed demo application on <a href="https://codesandbox.io/s/github/dojo/dojo.io/tree/master/site/source/tutorials/1010_containers_and_injecting_state/demo/finished/biz-e-corp" target="_blank" rel="noopener">codesandbox.io</a> or alternatively <a href="../assets/1010_containers_and_injecting_state-finished.zip">download</a> the project.</p>
</section>

				</div>
			</div>
		</div>
	</div>
</section>
<div id="mobile-sidebar" class="sidebar-left" uk-offcanvas>
	<div class="uk-offcanvas-bar">
		<div>
			<ul class="uk-nav" data-uk-nav>
	<li><a class="navbar-item" href="/docs.html">Docs</a></li>
<li><a class="navbar-item " href="/tutorials">Tutorials</a></li>
<li><a class="navbar-item" href="/blog">Blog</a></li>
<li><a class="navbar-item" href="/community">Community</a></li>
</ul>

			<hr>
			<ul class="uk-nav uk-nav-primary">
	<h3>Tutorials</h3>
	<li class="uk-nav-header">Getting Started</li>
	<li class="uk-nav-divider"></li>

	
			<li class><a href="/tutorials/000_local_installation/">Dojo local installation</a></li>
	
			<li class><a href="/tutorials/001_static_content/">Your first Dojo application</a></li>
	
			<li class><a href="/tutorials/002_creating_an_application/">Components of a Dojo application</a></li>
	
			<li class><a href="/tutorials/003_creating_widgets/">Creating widgets</a></li>
	
			<li class><a href="/tutorials/004_user_interactions/">Responding to events</a></li>
	
			<li class><a href="/tutorials/005_form_widgets/">Form widgets</a></li>
	
			<li class><a href="/tutorials/006_deploying_to_production/">Deploying to production</a></li>
	
			<li class="uk-nav-header">Advanced</li>
			<li class="uk-nav-divider"></li>
	
			<li class><a href="/tutorials/007_theming/">Theming</a></li>
	
			<li class><a href="/tutorials/008_animations/">Web Animations</a></li>
	
			<li class="uk-active"><a href="/tutorials/1010_containers_and_injecting_state/">State management</a></li>
	
			<li class><a href="/tutorials/1015_form_validation/">Form validation</a></li>
	
			<li class><a href="/tutorials/1020_registries/">Registry</a></li>
	
			<li class><a href="/tutorials/1030_routing/">Routing</a></li>
	
			<li class><a href="/tutorials/1050_development_environment/">Setting up a development environment</a></li>
	
			<li class><a href="/tutorials/1060_data_driven_widgets/">Data-driven widgets</a></li>
	
			<li class><a href="/tutorials/1070_custom_elements/">Creating Custom Elements</a></li>
	
</ul>

		</div>
	</div>
</div>

				</div>
				<footer class="footer uk-text-small uk-text-muted uk-container-expanded">
	<span>&copy; 2018 JS Foundation, All Rights Reserved.</span>
</footer>

			</div>
			
		</div>
		


<script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.0-rc.10/js/uikit.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.0-rc.10/js/uikit-icons.min.js"></script>
<script defer src="https://use.fontawesome.com/releases/v5.0.12/js/all.js" integrity="sha384-Voup2lBiiyZYkRto2XWqbzxHXwzcm4A5RfdfG6466bu5LqjwwrjXCMBQBLMWh7qR" crossorigin="anonymous"></script>

	</body>
</html>
